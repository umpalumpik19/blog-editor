(()=>{"use strict";var e=function(t,n,i,s){var o;n[0]=0;for(var a=1;a<n.length;a++){var l=n[a++],r=n[a]?(n[0]|=l?1:2,i[n[a++]]):n[++a];3===l?s[0]=r:4===l?s[1]=Object.assign(s[1]||{},r):5===l?(s[1]=s[1]||{})[n[++a]]=r:6===l?s[1][n[++a]]+=r+"":l?(o=t.apply(r,e(t,r,i,["",null])),s.push(o),r[0]?n[0]|=2:(n[a-2]=0,n[a]=o)):s.push(r)}return s},t=new Map;const n={EN:{none:"None",default:"Default",sharp:"Sharp shadow",small:"Small shadow",medium:"Medium shadow",large:"Large shadow",custom:"Custom",edit:"Edit",color:"Shadow color",opacity:"Opacity",x:"X-axis",y:"Y-axis",spread:"Spread",blur:"Blur",layer:"Layer",add_layer:"Add layer",delete_layer:"Delete layer",save:"Save",cancel:"Cancel",css:"CSS",copy:"Copy",layer_deleted:"Layer deleted",restore:"Restore",user_has_unsaved_changes_title:"You have unsaved changes",user_has_unsaved_changes_msg:"Shadow settings have been changed. Are you sure you want to close this panel without saving?",go_back:"Go back",exit_without_saving:"Exit without saving",invalid_shadow:"Invalid shadow format"},RU:{none:"Нет",default:"По умолчанию",sharp:"Резкая тень",small:"Легкая тень",medium:"Средняя тень",large:"Большая тень",custom:"Настраиваемая",edit:"Ред.",color:"Цвет тени",opacity:"Непрозрачность",x:"Ось X",y:"Ось Y",spread:"Растяжение",blur:"Размытие",layer:"Слой",add_layer:"Добавить слой",delete_layer:"Удалить слой",save:"Сохранить",cancel:"Отменить",css:"CSS",copy:"Скопировать",layer_deleted:"Слой удален",restore:"Восстановить",user_has_unsaved_changes_title:"Последние изменения не сохранены",user_has_unsaved_changes_msg:"Настройки тени были изменены. Вы уверены, что хотите закрыть панель без сохранения?",go_back:"Вернуться назад",exit_without_saving:"Выйти без сохранения",invalid_shadow:"Неверный формат тени"}};let i="cc";"undefined"!=typeof window&&(i=window.location.origin.split(".").pop(),"string"==typeof i&&2===i.length||(i="cc"));const s={ru:"com",by:"biz",kz:"pro",cc:"one"}[i]||"com",o=[`https://app.tildacdn.${s}/tfront/plugins/colorpicker/t-colorpicker.min.js`,`https://app.tildacdn.${s}/tfront/plugins/colorpicker/t-colorpicker.min.css`],a=[`https://app.tildacdn.${s}/tfront/plugins/previewbox/t-previewbox.min.js`,`https://app.tildacdn.${s}/tfront/plugins/previewbox/t-previewbox.min.css`],l=[`https://app.tildacdn.${s}/tfront/plugins/sortable-lite/t-sortable-lite.min.js`,`https://app.tildacdn.${s}/tfront/plugins/sortable-lite/t-sortable-lite.min.css`],r="https://static.tildacdn.com/lib/tplugins/shadowpicker",c=[{label:"none",empty:!0,img:`${r}/none.svg`},{label:"sharp",x:0,y:2,blur:3,spread:0,color:"#000b30",opacity:.25,img:`${r}/sharp.svg`},{label:"small",x:0,y:15,blur:30,spread:-10,color:"#000b30",opacity:.2,img:`${r}/small.svg`},{label:"medium",x:0,y:10,blur:20,spread:0,color:"#000b30",opacity:.25,img:`${r}/medium.svg`},{label:"large",x:0,y:10,blur:40,spread:-2,color:"#000b30",opacity:.3,img:`${r}/large.svg`},{label:"custom",custom:!0,img:`${r}/custom.svg`}],h={swatchesKey:window.projectid,swatchSize:18,swatchGap:4,panelGap:6,isPanelFixed:!0,clearBtnSize:12},p={selector:".tsp-panel__layer",handleSelector:".tsp-panel__layer-handle",axis:"y",isAutoUpdateEnabled:!0,dragImage:{zIndex:9999,className:"tsp-panel__drag-image"}},d={color:"#000000",opacity:1,x:0,y:0,blur:0,spread:0},u={color:{isColor:!0,placeholder:d.color,label:"color"},opacity:{isNumber:!0,min:0,max:100,factor:100,units:"%",placeholder:100*d.opacity+"%",label:"opacity"},x:{isNumber:!0,placeholder:d.x.toString(),label:"x",isSingleLine:!0},y:{isNumber:!0,placeholder:d.y.toString(),label:"y",isSingleLine:!0},blur:{isNumber:!0,min:0,placeholder:d.blur.toString(),label:"blur",isSingleLine:!0},spread:{isNumber:!0,placeholder:d.spread.toString(),label:"spread",isSingleLine:!0}},m=["color","opacity","x","y","blur","spread"],g=[`https://app.tildacdn.${s}/tfront/plugins/tooltip/t-tooltip.min.js`,`https://app.tildacdn.${s}/tfront/plugins/tooltip/t-tooltip.min.css`],w={position:"bottom",closeDelay:0,maxWidth:200};const f=function(n){var i=t.get(this);return i||(i=new Map,t.set(this,i)),(i=e(this,i.get(n)||(i.set(n,i=function(e){for(var t,n,i=1,s="",o="",a=[0],l=function(e){1===i&&(e||(s=s.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?a.push(0,e,s):3===i&&(e||s)?(a.push(3,e,s),i=2):2===i&&"..."===s&&e?a.push(4,e,0):2===i&&s&&!e?a.push(5,0,!0,s):i>=5&&((s||!e&&5===i)&&(a.push(i,0,s,n),i=6),e&&(a.push(i,e,0,n),i=6)),s=""},r=0;r<e.length;r++){r&&(1===i&&l(),l(r));for(var c=0;c<e[r].length;c++)t=e[r][c],1===i?"<"===t?(l(),a=[a],i=3):s+=t:4===i?"--"===s&&">"===t?(i=1,s=""):s=t+s[0]:o?t===o?o="":s+=t:'"'===t||"'"===t?o=t:">"===t?(l(),i=1):i&&("="===t?(i=5,n=s,s=""):"/"===t&&(i<5||">"===e[r][c+1])?(l(),3===i&&(a=a[0]),i=a,(a=a[0]).push(2,0,i),i=0):" "===t||"\t"===t||"\n"===t||"\r"===t?(l(),i=2):s+=t),3===i&&"!--"===s&&(i=4,a=a[0])}return l(),a}(n)),i),arguments,[])).length>1?i:i[0]}.bind((function(e,t){this[0]=3;for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];if("function"==typeof e){const n=new e(t).render();return n.append(...i.flat()),n}if("string"==typeof e){const n=["svg","circle"].includes(e)?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return t&&Object.entries(t).forEach((e=>{let[t,i]=e;if(t.startsWith("on"))Array.isArray(i)?i.forEach((e=>n.addEventListener(t.substring(2).toLowerCase(),e))):n.addEventListener(t.substring(2).toLowerCase(),i);else if("className"===t)n.classList.add(...i.split(" "));else if("tooltip"===t)s=n,o=i,b(g).then((()=>{if(!window.Tooltip)return;const e=new window.Tooltip({...w,target:s,content:{title:o}});s.updateTooltipContent=e.updateContent.bind(e)}));else if("bindTo"===t){if(Array.isArray(i)){const[e,t]=i;e&&"object"==typeof e&&"string"==typeof t&&(e[t]=n)}}else["string","number"].includes(typeof i)?n.setAttribute(t,i):"boolean"==typeof i&&i&&n.setAttribute(t,"");var s,o})),n.append(...i.flat()),n}if(e instanceof Element)return e}));function v(){const e=[];return{on:t=>{e.push(t)},trigger:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];e.forEach((e=>e(...n)))}}}function b(e){const t=(Array.isArray(e)?e:[e]).map((e=>{const t=e.split(".").pop(),n=e+(window.ver?"?v="+window.ver:"");return["js","css"].includes(t)?function(e,t){return new Promise(((n,i)=>{const s="style"===t,o=s?"link":"script",a=s?"href":"src";let l;try{const{pathname:t}=new URL(e,window.location.href);l=t}catch(t){l=e}const r=document.querySelector(`${o}[${a}*="${l}"]`);if(r)return"true"===r.getAttribute("data-loading")?(r.addEventListener("load",n),void r.addEventListener("error",i)):n();const c=document.createElement(o);c.setAttribute(a,e),s&&c.setAttribute("rel","stylesheet"),c.setAttribute("data-loading","true"),c.addEventListener("load",(()=>(c.removeAttribute("data-loading"),n()))),c.addEventListener("error",(()=>(document.head.removeChild(c),i()))),document.head.appendChild(c)}))}(n,"js"===t?"script":"style"):Promise.reject("Unknown resource extension. Make sure the resource url ends with .css or .js")}));return Promise.all(t)}function y(e,t){const n=function(e){return e="string"==typeof e?e.replace(/#/g,""):"",[parseInt(e.substring(0,2),16)||0,parseInt(e.substring(2,4),16)||0,parseInt(e.substring(4,6),16)||0]}(e);return`rgba(${n.join(",")},${t})`}function _(e){return(e=Array.isArray(e)?e:[e]).filter((e=>{let{isDeleted:t}=e;return!t})).map((e=>{const t=["x","y","blur","spread","color","opacity"];if(t.every((t=>[null,void 0,d[t]].includes(e[t]))))return"";const n={...e};t.forEach((e=>{if("color"===e)n[e]=n[e]||d[e];else{const t=parseInt(n[e],10);n[e]=isNaN(t)?d[e]:n[e]}}));const{x:i,y:s,blur:o,spread:a,color:l,opacity:r}=n,c=y(l,r);return`${i}px ${s}px${o!==d.blur||a!==d.spread?` ${o}px`:""}${a!==d.spread?` ${a}px`:""} ${c}`})).filter((e=>e)).join(",")}function $(e,t,n){return Math.max(e,Math.min(t,n))}function x(e,t){return n[t][e]||n.EN[e]||e}async function k(e,t){if((e=(e="string"==typeof e?e:"").toLowerCase().replace(/(box|text)-shadow:/g,"").replace(/;/g,",").replace(/\n/g,"").replace(/,$/,"").trim())&&!/^(\s*(?:-?\d+(?:\.\d+)?(?:px)?\s+-?\d+(?:\.\d+)?(?:px)?\s+(?:\d+(?:\.\d+)?(?:px)?\s+)?(?:\d+(?:\.\d+)?(?:px)?\s+)?(?:(?:rgb|hsl)a?\([^)]+\)|#?[a-z0-9]+))\s*,?\s*)+$/.test(e))return"function"==typeof window.tp__showCornerNotice&&window.tp__showCornerNotice(t,3e3),[{x:null,y:null,blur:null,spread:null,color:null,opacity:null}];const n=e.split(/,(?![^(]*\))/);await b(o);return n.map((e=>{const t=e.trim().replace(/\s{2,}/g," ").replace(/\s{0,},\s{0,}/g,",").split(" "),n=t.pop()||"",i=window.TColorPicker.parseColor(n),s=n&&!isNaN(i[3])&&i[3]!==d.opacity?i[3]:null;let o=n?"#"+window.TColorPicker.hslToHEX(i):null;o=o===d.color?null:o;const a={opacity:s,color:o};return["x","y","blur","spread"].forEach(((e,n)=>{const i=parseInt(t[n],10);a[e]=isNaN(i)||i===d[e]?null:i})),a}))}function E(e){const t=e=>{if(!e)return!1;const t=window.getComputedStyle(e),n=["auto","scroll"].includes(t.overflowX),i=["auto","scroll"].includes(t.overflowX),{offsetHeight:s,scrollHeight:o,offsetWidth:a,scrollWidth:l}=e;return l>a&&n||o>s&&i};e.addEventListener("wheel",(n=>{const{deltaX:i,deltaY:s,target:o}=n,a=(n=>{let i=n;for(;!t(i)&&(i=i.parentElement,i!==e&&i!==document.documentElement););return i})(o);let l;var r;l=Math.abs(i)>Math.abs(s)?"horizontal":Math.abs(i)<Math.abs(s)?"vertical":"both",(["vertical","both"].includes(l)&&((r=a)&&0===r.scrollTop&&s<0||(e=>e&&Math.ceil(e.scrollTop+e.clientHeight)>=e.scrollHeight)(a)&&s>0)||["horizontal","both"].includes(l)&&((e=>e&&0===e.scrollLeft)(a)&&i<0||(e=>e&&Math.ceil(e.scrollLeft+e.clientWidth)>=e.scrollWidth)(a)&&i>0))&&n.preventDefault()}),{passive:!1})}function T(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function S(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var N=new WeakSet;class C{constructor(e){T(this,N),e="[object Object]"===Object.prototype.toString.call(e)?e:{},this.props={options:Array.isArray(e.options)?e.options:[],value:"string"==typeof e.value?e.value:"",changeHandler:"function"==typeof e.changeHandler?e.changeHandler:function(){}}}render(){const e=this.props.options.map((e=>f`
				<option
					value=${e.value}
					selected=${e.value===this.props.value}
					disabled=${!!e.disabled}
				>
					${e.label}
				</option>
			`));return this.element=f`
			<select
				className="tsp-panel__select"
				onChange=${[S(this,N,L).bind(this),this.props.changeHandler]}
			></select>
		`,this.element.append(...e),S(this,N,L).call(this),this.element}set value(e){this.element.value=e,S(this,N,L).call(this)}}function L(){const e=this.element.selectedOptions[0],t=document.createElement("div");t.classList.add("tsp-select-helper"),t.innerText=e.innerText,document.body.appendChild(t),this.element.style.width=`${t.offsetWidth}px`,t.remove()}function D(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function I(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var W=new WeakSet;class P{constructor(e){D(this,W),this.props=e,this.props.updateTrigger.on(I(this,W,H).bind(this))}render(){return this.element=f`
			<div className="tsp-preview">
				<div className="tsp-preview__box" bindTo=${[this,"previewBox"]}></div>
			</div>
		`,I(this,W,H).call(this),this.element}}function H(){const e=_(this.props.settings);this.previewBox.style.boxShadow=e}function j(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function z(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var A=new WeakSet,B=new WeakSet,O=new WeakSet,M=new WeakSet,R=new WeakSet,F=new WeakSet;class K{constructor(e){j(this,F),j(this,R),j(this,M),j(this,O),j(this,B),j(this,A),e="[object Object]"===Object.prototype.toString.call(e)?e:{},this.props={label:x(e.label||"",e.lang),min:isNaN(e.min)?null:e.min,max:isNaN(e.max)?null:e.max,units:"string"==typeof e.units?e.units:"",factor:e.factor&&!isNaN(e.factor)?e.factor:null,placeholder:"string"==typeof e.placeholder?e.placeholder:"",isColor:!!e.isColor,isNumber:!!e.isNumber,isSingleLine:!!e.isSingleLine,value:e.value,name:e.name||"",inputHandler:"function"==typeof e.inputHandler?e.inputHandler:function(){},blurHandler:"function"==typeof e.blurHandler?e.blurHandler:function(){},isCopyButton:!!e.isCopyButton,isSelectOnFocus:!!e.isSelectOnFocus,colorPickers:e.colorPickers||[],theme:e.theme,lang:e.lang,zIndex:e.zIndex}}render(){const{isColor:e,isSingleLine:t,inputHandler:n,label:i,name:s,isCopyButton:o,lang:a}=this.props;return this.element=f`
			<label className="tsp-panel__input-label${t?" tsp-panel__input-label_line":""}">
				<span className="tsp-panel__input-span">${i}</span>
				<input
					type="text"
					className="tsp-panel__input"
					placeholder=${this.props.placeholder}
					onFocus=${z(this,B,U).bind(this)}
					onBlur=${[z(this,O,Y).bind(this),this.props.blurHandler]}
					onKeydown=${z(this,M,q).bind(this)}
					name=${s}
					onInput=${e?void 0:n}
					onColorchange=${e?n:void 0}
					bindTo=${[this,"input"]}
				/>
				<button
					className="tsp-panel__input-btn${o?"":" tsp-panel__input-btn_hidden"}"
					type="button"
					tooltip=${x("copy",a)}
					onClick=${z(this,F,Z).bind(this)}
					bindTo=${[this,"copyButton"]}
				></button>
			</label>
		`,e?z(this,A,X).call(this):this.value=this.props.value,this.element}set value(e){if(null===e)return void(this.input.value="");e=String(e);const{units:t,isNumber:n,isColor:i,factor:s}=this.props;if(n){s&&(e*=s);e=z(this,R,G).call(this,e)+t}i&&this.colorpicker?this.colorpicker.color=e:this.input.value=e}get value(){const{value:e}=this.input,{isNumber:t,isColor:n,factor:i}=this.props;if(!e&&!n)return null;if(t){let t=z(this,R,G).call(this,e);return i&&(t/=i),t}if(n){if(!this.colorpicker||!this.colorpicker.color)return null;const e=this.colorpicker.color;return"#"+window.TColorPicker.hslToHEX(e)}return e}}function X(){const{theme:e,lang:t,zIndex:n}=this.props;b(o).then((()=>{this.colorpicker=new window.TColorPicker(this.input,{...h,theme:e,lang:t,panelZIndex:n+1}),this.colorpicker.init(),this.props.colorPickers.push(this.colorpicker),this.value=this.props.value})).catch((()=>{throw new Error("Error loading colorpicker")}))}function U(){const{isNumber:e,units:t,isSelectOnFocus:n}=this.props;n&&this.input.select();const{value:i}=this.input;if(!e||!t||!i)return;const s=parseInt(i,10)||0;this.input.value=s}function Y(){const{isNumber:e,units:t}=this.props,{value:n}=this.input;if(!e||!n)return;const i=z(this,R,G).call(this,n);this.input.value=i+(t||"")}function q(e){const{isNumber:t}=this.props;if(!t||!["ArrowUp","ArrowDown"].includes(e.key))return;e.preventDefault();const n=parseInt(this.input.value,10)||0,i="ArrowUp"===e.key?n+1:n-1,s=z(this,R,G).call(this,i);this.input.value=s,this.input.dispatchEvent(new Event("input"))}function G(e){const{min:t,max:n,isNumber:i}=this.props;if(!i)return;let s=parseInt(e,10)||0;return null!==t&&(s=Math.max(t,s)),null!==n&&(s=Math.min(n,s)),s}function Z(){const{value:e}=this.input;navigator.clipboard.writeText(e),this.copyButton.classList.add("tsp-panel__input-btn_done"),window.clearTimeout(this.copyButton.copyTimeout),this.copyButton.copyTimeout=window.setTimeout((()=>{this.copyButton.classList.remove("tsp-panel__input-btn_done")}),1e3)}function J(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function Q(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var V=new WeakSet;class ee{constructor(e){J(this,V),this.props=e,this.inputs=[]}render(){const{isExpanded:e,isDeleted:t}=this.props.settings,{lang:n,zIndex:i}=this.props;if(t){const e=$(0,(Date.now()-this.props.settings.deleteTimestamp)/1e3/3,1),t=Math.round(3*(1-e));this.element=f`
				<div className="tsp-panel__layer">
					<div
						className="tsp-panel__layer-header tsp-panel__layer-header_deleted tsp-panel__section"
						style=${`--time-shift:${e}; --delete-delay:3s;`}
					>
						<span className="tsp-panel__layer-deleted-span">${x("layer_deleted",n)}</span>
						<button
							type="button"
							className="tsp-panel__layer-deleted-button"
							onClick=${this.props.restoreHandler}
						>
							<svg className="tsp-panel__layer-deleted-circle" viewBox="0 0 14 14">
								<circle r="6" cx="7" cy="7"></circle>
							</svg>
							<span className="tsp-panel__layer-deleted-counter" bindTo=${[this,"counterElement"]}>
								${t}
							</span>
							${x("restore",n)}
						</button>
					</div>
				</div>
			`;const i=window.setInterval((()=>{const e=$(0,(Date.now()-this.props.settings.deleteTimestamp)/1e3/3,1),t=Math.round(3*(1-e));this.counterElement.innerText=t,t||window.clearInterval(i)}),50);return this.element}const s=m.map((e=>{const t=u[e];t.value=this.props.settings[e];const s=new K({...t,name:e,inputHandler:Q(this,V,te).bind(this),colorPickers:this.props.colorPickers,theme:this.props.theme,lang:n,zIndex:i});return this.inputs.push(s),s.render()}));return this.element=f`
			<div className="tsp-panel__layer${e?" tsp-panel__layer_expanded":""}">
				<div className="tsp-panel__layer-header tsp-panel__section">
					<div className="tsp-panel__layer-handle"></div>
					<button type="button" className="tsp-panel__layer-button" onClick=${this.props.expandHandler}>
						${x("layer",n)} ${this.props.settings.order}
					</button>
					<button
						type="button"
						className="tsp-panel__layer-delete"
						onClick=${this.props.deleteHandler}
						tooltip=${x("delete_layer",n)}
					></button>
				</div>
				<div className="tsp-panel__layer-inputs tsp-panel__section">${s}</div>
			</div>
		`,this.element}}function te(e){const{name:t}=e.target,n=this.inputs.find((e=>{let{input:n}=e;return n.name===t}));if(!n)return;const i=n.value;this.props.settings[t]=i,this.props.updateTrigger&&this.props.updateTrigger.trigger()}function ne(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function ie(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var se=new WeakSet,oe=new WeakSet,ae=new WeakSet,le=new WeakSet,re=new WeakSet,ce=new WeakSet,he=new WeakSet,pe=new WeakSet;class de{constructor(e){ne(this,pe),ne(this,he),ne(this,ce),ne(this,re),ne(this,le),ne(this,ae),ne(this,oe),ne(this,se),this.props=e}render(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.props.colorPickers.forEach((e=>e.destroy())),this.props.colorPickers.splice(0);const{settings:t,theme:n,lang:i,zIndex:s}=this.props;return t.forEach(((o,a)=>{o.order=a+1,e&&1!==t.length||(o.isExpanded=a===t.length-1),o.element=f`
				<${ee}
					settings=${o}
					updateTrigger=${this.props.updateTrigger}
					deleteHandler=${ie(this,le,we).bind(this)}
					restoreHandler=${ie(this,ce,ve).bind(this)}
					expandHandler=${ie(this,he,be).bind(this)}
					colorPickers=${this.props.colorPickers}
					theme=${n}
					lang=${i}
					zIndex=${s}
				/>
			`})),this.element=f`
			<div className="tsp-panel__layers${1===t.length?" tsp-panel__layers_single":""}">
				${t.map((e=>{let{element:t}=e;return t}))}
				<div className="tsp-panel__section tsp-panel__layers-btn-wrapper">
					<button type="button" className="tsp-panel__layers-btn" onClick=${ie(this,ae,ge).bind(this)}>
						${x("add_layer",i)}
					</button>
				</div>
			</div>
		`,ie(this,se,ue).call(this),this.element}update(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;this.sortable&&this.sortable.destroy();const i=this.element,{scrollTop:s}=i;this.render(e),i.replaceWith(this.element),this.element.scrollTo(0,e?s:this.element.scrollHeight),n||this.props.updateTrigger.trigger(t)}}function ue(){const{theme:e}=this.props;this.props.settings.length<=1||("dark"===e&&(p.dragImage.className="tsp-panel__drag-image_dark"),b(l).then((()=>{this.sortable=new window.TSortableLite(this.element,{...p,onDrop:ie(this,oe,me).bind(this)}).init()})))}function me(e){const{prevEl:t,nextEl:n}=e.relativeTargets,i=e.draggingElement,{settings:s}=this.props;if(!t&&!n||!i)return;const o=!!t,a=s.find((e=>{let{element:t}=e;return t===i})),l=s.find((e=>{let{element:i}=e;return i===(o?t:n)}));if(!a||!l)return;const r=s.indexOf(a);s.splice(r,1);const c=s.indexOf(l);s.splice(o?c+1:c,0,a),this.update(!0)}function ge(){const{settings:e}=this.props,t={...e[e.length-1]||ie(this,pe,ye).call(this)};Object.keys(t).forEach((e=>{m.includes(e)||delete t[e],"x"!==e&&"y"!==e||!t[e]||(t[e]*=-1)})),e.push(t),this.update()}function we(e){const{settings:t}=this.props,n=e.target.closest(".tsp-panel__layer"),i=t.find((e=>{let{element:t}=e;return t===n}));i.isDeleted=!0,i.deleteTimestamp=Date.now(),i.deleteTimeout=window.setTimeout(ie(this,re,fe).bind(this,i),3e3),this.update(!0)}function fe(e){const{settings:t}=this.props,n=t.indexOf(e);-1!==n&&(t.splice(n,1),t.length||t.push(ie(this,pe,ye).call(this)),this.update(!0,!1,!0))}function ve(e){const{settings:t}=this.props,n=e.target.closest(".tsp-panel__layer"),i=t.find((e=>{let{element:t}=e;return t===n}));window.clearTimeout(i.deleteTimeout),delete i.deleteTimeout,delete i.isDeleted,delete i.deleteTimestamp,this.update(!0)}function be(e){const{settings:t}=this.props,n=e.target.closest(".tsp-panel__layer"),i=n.classList.contains("tsp-panel__layer_expanded"),s=t.find((e=>{let{element:t}=e;return t===n}));if(i)s.isExpanded=!1,n.classList.remove("tsp-panel__layer_expanded");else{const e=t.find((e=>{let{isExpanded:t}=e;return t}));e&&(e.isExpanded=!1,e.element.classList.remove("tsp-panel__layer_expanded")),s.isExpanded=!0,n.classList.add("tsp-panel__layer_expanded")}}function ye(){const e={};return m.forEach((t=>e[t]=null)),e}function _e(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function $e(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var xe=new WeakSet,ke=new WeakSet,Ee=new WeakSet,Te=new WeakSet,Se=new WeakSet,Ne=new WeakSet,Ce=new WeakSet;class Le{constructor(e){_e(this,Ce),_e(this,Ne),_e(this,Se),_e(this,Te),_e(this,Ee),_e(this,ke),_e(this,xe),e="[object Object]"===Object.prototype.toString.call(e)?e:{},this.settings=e.settings,this.initialShadow=_(this.settings),this.closeHandler="function"==typeof e.closeHandler?e.closeHandler:function(){},this.relatedElement=e.relatedElement,this.editButton=e.editButton,this.shadowChangeTrigger=e.shadowChangeTrigger,this.colorPickers=[],this.theme=e.theme,this.altNoLabel=e.altNoLabel,this.lang=e.lang,this.zIndex=e.zIndex,this.handleDocClick=this.handleDocClick.bind(this),this.handleDocKeyDown=this.handleDocKeyDown.bind(this),this.handleDocPointerDown=this.handleDocPointerDown.bind(this),this.handleTransitionEnd=this.handleTransitionEnd.bind(this),this.updateTrigger=v(),this.updateTrigger.on($e(this,Te,Pe).bind(this))}render(){const{lang:e,zIndex:t}=this;this.cssInput=new K({label:"css",isSingleLine:!0,value:_(this.settings),blurHandler:$e(this,Se,He).bind(this),inputHandler:$e(this,Se,He).bind(this),isCopyButton:!0,isSelectOnFocus:!0,lang:e}),this.layersCollection=new de({settings:this.settings,updateTrigger:this.updateTrigger,colorPickers:this.colorPickers,theme:this.theme,lang:this.lang,zIndex:this.zIndex});const n=c.map((t=>{let n="";t.custom?n="custom":t.empty||(n=_(t));return{value:n,label:x("none"===t.label&&this.altNoLabel?"default":t.label,e),disabled:t.custom}}));let i=_(this.settings);return i=n.find((e=>{let{value:t}=e;return t===i}))?i:"custom",this.select=new C({value:i,options:n,changeHandler:$e(this,Ne,je).bind(this)}),this.element=f`
			<div
				className="tsp-panel tsp-panel_hidden${"dark"===this.theme?" tsp-panel_dark":""}"
				style=${`z-index:${t};`}
			>
				<div className="tsp-panel__section tsp-panel__header">
					${this.select.render()}
					<button className="tsp-panel__header-btn" onClick=${$e(this,ke,Ie).bind(this)}></button>
				</div>
				<${P} updateTrigger=${this.updateTrigger} settings=${this.settings} />
				${this.layersCollection.render()}
				<div className="tsp-panel__section tsp-panel__footer">${this.cssInput.render()}</div>
			</div>
		`,E(this.element),$e(this,xe,De).call(this),this.element}handleTransitionEnd(){this.element.remove(),this.element.removeEventListener("transitionend",this.handleTransitionEnd)}handleDocClick(e){const t=this.colorPickers.some((e=>e&&e.panelState));this.element.contains(e.target)||e.target.closest("#confirm-dialog")||this.editButton.contains(e.target)||t||this.isPointerDownOnPanel?this.isPointerDownOnPanel=!1:$e(this,ke,Ie).call(this)}handleDocKeyDown(e){const t=this.colorPickers.some((e=>e&&e.panelState));"Escape"!==e.key||t||document.querySelector("#confirm-dialog")||$e(this,ke,Ie).call(this)}handleDocPointerDown(e){this.isPointerDownOnPanel=this.element.contains(e.target)}}function De(){document.body.contains(this.element)||($e(this,Ee,We).call(this),document.addEventListener("click",this.handleDocClick),document.addEventListener("keydown",this.handleDocKeyDown),document.addEventListener("pointerdown",this.handleDocPointerDown),window.setTimeout((()=>{this.element.classList.remove("tsp-panel_hidden")}),0))}function Ie(){document.body.contains(this.element)&&(document.removeEventListener("click",this.handleDocClick),document.removeEventListener("keydown",this.handleDocKeyDown),document.removeEventListener("pointerdown",this.handleDocPointerDown),this.layersCollection.sortable&&this.layersCollection.sortable.destroy(),this.closeHandler(),this.element.addEventListener("transitionend",this.handleTransitionEnd),this.element.classList.add("tsp-panel_hidden"))}function We(){if(!(this.relatedElement instanceof Element))return;const{top:e,height:t,left:n,width:i}=this.relatedElement.getBoundingClientRect(),{clientWidth:s,clientHeight:o}=document.documentElement,a=-200,l=o-e-t-a-5>=550,r=s-n-i-10-5>=225,c=n-10-5>=225;let h="0px",p="0px";r||!l&&!r&&!c?(h=`${n+i+10}px`,p=`${e+a}px`):l?(h=`${n}px`,p=`${e+t+a}px`):c&&(h=`calc(${n-10}px - 100%)`,p=`${e+a}px`),this.element.style.setProperty("--pos-x",h),this.element.style.setProperty("--pos-y",p)}function Pe(e){const t=_(this.settings);e||(this.cssInput.value=t);const n=[...this.select.element.options].find((e=>{let{value:n}=e;return n===t}));this.select.value=n?n.value:"custom",this.shadowChangeTrigger.trigger(t)}function He(e){const{value:t}=this.cssInput;$e(this,Ce,ze).call(this,t,"input"===e.type)}function je(){const{value:e}=this.select.element;$e(this,Ce,ze).call(this,e)}async function ze(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=x("invalid_shadow",this.lang),i=await k(e,n);this.settings.splice(0,this.settings.length),this.settings.push(...i),this.layersCollection.update(!1,t,!0),this.updateTrigger.trigger(t)}class Ae extends CustomEvent{constructor(e){super("paneltoggle"),this.isOpen=e}}function Be(e,t){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.add(e)}function Oe(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var Me=new WeakSet,Re=new WeakSet,Fe=new WeakSet,Ke=new WeakSet,Xe=new WeakSet,Ue=new WeakSet,Ye=new WeakSet,qe=new WeakSet,Ge=new WeakSet,Ze=new WeakSet;function Je(){this.select=Oe(this,Re,Qe).call(this);const{theme:e,lang:t}=this.config;this.container=f`
			<div className="tsp${"dark"===e?" tsp_dark":""}">
				${this.select}
				<button
					type="button"
					className="tsp__edit"
					onClick=${Oe(this,qe,st).bind(this)}
					bindTo=${[this,"editButton"]}
				>
					${x("edit",t)}
				</button>
			</div>
		`,this.noActionLayer=f`
			<div className="tsp__noaction"></div>
		`,this.input.after(this.container),this.input.type="hidden",this.container.append(this.input),Oe(this,Xe,tt).call(this)}function Qe(){const e=f`
			<select className="tsp__select" onInteraction=${Oe(this,Ue,nt).bind(this)}></select>
		`,t=Oe(this,Fe,Ve).call(this);return e.append(...t),e}function Ve(){const e=this.input.value,t=c.map((e=>_(e))).some((t=>t===e)),{altNoLabel:n,lang:i}=this.config;return t||(this.previousInitialShadow=e),c.map((s=>{let o="";s.custom?o="custom":s.empty||(o=_(s));const a=x("none"===s.label&&n?"default":s.label,i);return f`
				<option
					value=${o}
					data-img=${s.img}
					selected=${o===e||s.custom&&!t}
				>
					${s.custom&&this.previousInitialShadow?this.previousInitialShadow:a}
				</option>
			`}))}function et(){this.select.innerHTML="";const e=Oe(this,Fe,Ve).call(this);this.select.append(...e),this.previewBox&&this.previewBox.update()}function tt(){const{theme:e,height:t}=this.config;b(a).then((()=>{this.previewBox=new window.TPreviewbox(this.select,{theme:e,height:t})})).catch((()=>{throw new Error("Fail to load previewbox")}))}function nt(){const e=this.select.value;this.input.value="custom"===e?this.previousInitialShadow:e,this.input.dispatchEvent(new Event("change")),Oe(this,Ke,et).call(this),"custom"===e&&Oe(this,Ye,it).call(this,this.previousInitialShadow)}async function it(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.isPanelRendered)return;const{theme:t,lang:n}=this.config,i=x("invalid_shadow",n),s=await k(e,i),{altNoLabel:o,zIndex:a}=this.config;document.body.append(f`
			<${Le}
				settings=${s}
				relatedElement=${this.container.querySelector(".tprev")||this.container}
				closeHandler=${Oe(this,Ge,ot).bind(this)}
				shadowChangeTrigger=${this.shadowChangeTrigger}
				editButton=${this.editButton}
				theme=${t}
				altNoLabel=${o}
				lang=${n}
				zIndex=${a}
			/>
		`),this.isPanelRendered=!0,document.body.append(this.noActionLayer),this.input.dispatchEvent(new Ae(!0))}function st(){Oe(this,Ye,it).call(this,this.input.value)}function ot(){this.isPanelRendered=!1,this.noActionLayer.remove(),this.input.dispatchEvent(new Ae(!1))}function at(e){this.input.value=e,this.input.dispatchEvent(new Event("change")),Oe(this,Ke,et).call(this)}window.TShadowPicker=class{constructor(e,t){if(Be(this,Ze),Be(this,Ge),Be(this,qe),Be(this,Ye),Be(this,Ue),Be(this,Xe),Be(this,Ke),Be(this,Fe),Be(this,Re),Be(this,Me),!(e instanceof HTMLInputElement))throw new TypeError("Input must be an instance of HTMLInputElement");t="[object Object]"===Object.prototype.toString.call(t)?t:{};let i="EN";const s=Object.keys(n);s.includes(t.lang)?i=t.lang:s.includes(window.lang)&&(i=window.lang),this.config={shadowChangeDelay:!isNaN(t.shadowChangeDelay)&&t.shadowChangeDelay>=0?t.shadowChangeDelay:50,theme:["light","dark"].includes(t.theme)?t.theme:"light",height:!isNaN(t.height)&&t.height>0?t.height:40,altNoLabel:!!t.altNoLabel,zIndex:isNaN(t.zIndex)?9998:t.zIndex,lang:i},this.input=e,this.isPanelRendered=!1,this.previousInitialShadow="",this.shadowChangeTrigger=v(),this.shadowChangeTrigger.on(function(e,t){let n=null;return function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];n||(n=window.setTimeout((()=>{e.apply(null,s),window.clearTimeout(n),n=null}),t))}}(Oe(this,Ze,at).bind(this),this.config.shadowChangeDelay)),Oe(this,Me,Je).call(this)}}})();