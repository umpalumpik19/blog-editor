function t396_initTooltip(t){t396_tooltip__createPortal(),"click"===t396_tooltip__determineMode(t)?t396_tooltip__setupClick(t):t396_tooltip__setupHover(t),t396_tooltip__setupImages()}function t396_tooltip__createPortal(){var t;if(!document.querySelector(".t396__tooltip-portal")){var e='\n\t\t<div class="t396__tooltip-portal"></div>\n\t';document.body.insertAdjacentHTML("beforeend",e)}}function t396_tooltip__setupClick(t){var e=t.querySelector(".tn-atom__pin"),o=t.querySelector(".tn-atom__tip"),i;e&&o&&("true"===e.getAttribute("data-tooltip-setup")||(e.addEventListener("click",(function(e){t396_tooltip__isShown(o)?t396_tooltip__hide(t):(t396_tooltip__hideAll(e),t396_tooltip__show(t))})),document.addEventListener("click",t396_tooltip__hideAll),e.setAttribute("data-tooltip-setup","true")))}function t396_tooltip__setupHover(t){var e=t.querySelector(".tn-atom__pin"),o=t.querySelector(".tn-atom__tip"),i;if(e&&o&&!("true"===e.getAttribute("data-tooltip-setup"))){var n,r=[e,o];r.forEach((function(e){e.addEventListener("mouseover",(function(e){t396_tooltip__hideAll(e),clearTimeout(n),t396_tooltip__isShown(o)||t396_tooltip__show(t)}))})),r.forEach((function(e){e.addEventListener("mouseout",(function(){n=setTimeout((function(){t396_tooltip__hide(t)}),300)}))})),e.setAttribute("data-tooltip-setup","true")}}function t396_tooltip__show(t){var e=t.querySelector(".tn-atom__pin"),o=t.querySelector(".tn-atom__tip"),i=t396_tooltip__moveToPortal(o);t.restorePosition=i;var n,r=t.closest(".t396__artboard").getAttribute("data-artboard-recid"),a=window.tn.isEditMode?1:t396__getCurrentScaleFactor(r),l=t396_tooltip__getCoordinates(t,e,o,a);o.style.left=l.left+"px",o.style.top=l.top+"px",o.style.transform="translate(0, 0)",window.tn.isEditMode||(o.style.zoom=a),o.classList.add("tn-atom__tip_visible"),o.style.display="block",o.addEventListener("click",(function(t){t.stopPropagation()})),t396_tooltip__hideOnScroll(t,2e3);var s=t396_tooltip__setupPositionSync(t,e,o);t.cleanupPositionSync=s}function t396_tooltip__hide(t){var e;null!=t&&t.restorePosition&&null!=t&&null!=(e=t.restorePosition)&&e.restore&&(t.restorePosition.restore(),delete t.restorePosition),null!=t&&t.cleanupPositionSync&&(t.cleanupPositionSync(),delete t.cleanupPositionSync);var o=t.querySelector(".tn-atom__tip");o.classList.remove("tn-atom__tip_visible"),o.style.display="none",o.style.zoom=""}function t396_tooltip__hideAll(t){var e=null==t?void 0:t.target;if(!(t&&t.target&&t.target.classList.contains("tp-view__handle"))){var o=null==e?void 0:e.closest(".t396__elem"),i,n;document.querySelector(".t396__tooltip-portal").querySelectorAll(".tn-atom__tip_visible").forEach((function(t){var e,i,n=t396_tooltip__getTooltipElement(t.dataset.recId,t.dataset.elementId);o!==n&&t396_tooltip__hide(n)}))}}function t396_tooltip__getCoordinates(t,e,o,i){var n=window.t396__isSafari&&1!==i?i:1;function r(t){return t/i*n}function a(t){return t/n*i}var l=t.getAttribute("data-field-tipposition-value")||"top",s=e.getBoundingClientRect();o.style.display="block";var c=o.getBoundingClientRect();o.style.display="none";for(var d=15*i,u=r(window.pageXOffset),_=r(window.pageYOffset),p=document.documentElement.clientWidth,f=document.documentElement.clientHeight,v=function t(e){var o;return{top:function t(){return{left:r(s.left+s.width/2)-c.width/2+u,top:r(s.top)-c.height-d+_}},right:function t(){return{left:r(s.right)+d+u,top:r(s.top+s.height/2)-c.height/2+_}},bottom:function t(){return{left:r(s.left+s.width/2)-c.width/2+u,top:r(s.bottom)+d+_}},left:function t(){return{left:r(s.left)-c.width-d+u,top:r(s.top+s.height/2)-c.height/2+_}}}[e]()},m=function e(o,r){var l=r,s=t.closest(".t-record-container"),d=o.top,v=window.tn.isEditMode?o.left-s.offsetLeft:o.left;return("top"===l||"bottom"===l)&&(v+c.width)*i-a(u)>p&&(l="left"),("top"===l||"bottom"===l)&&v-u/n<0&&(l="right"),"top"===l&&d-_/n<0&&(l="bottom"),"right"===l&&(v+c.width)*i-a(u)>p&&(l="bottom"),"bottom"===l&&(d+c.height)*i-a(_)>f&&(l="top"),"left"===l&&v-u/n<0&&(l="top"),l},w=v(l),h=m(w,l),g=l;h!==g;){var b;g=h=m(v(h),h)}if(h!==l){var y=v(h);w.left=y.left,w.top=y.top}return{top:w.top,left:w.left,position:h}}function t396_tooltip__moveToPortal(t){var e=t.closest(".t396__elem"),o=e.closest(".t396__artboard"),i;return t.dataset.elementId=e.getAttribute("data-elem-id"),t.dataset.recId=o.getAttribute("data-artboard-recid"),document.querySelector(".t396__tooltip-portal").appendChild(t),{restore:function o(){var i;e.querySelector(".tn-atom__pin").appendChild(t),delete t.dataset.elementId,delete t.dataset.recId}}}function t396_tooltip__determineMode(t){var e=t.getAttribute("data-field-tipopen-value");return window.t396__isMobile||"click"===e?"click":"hover"}function t396_tooltip__setupPositionSync(t,e,o){for(var i=t.closest(".t396__artboard"),n=i.getAttribute("data-artboard-recid"),r=window.tn.isEditMode?1:t396__getCurrentScaleFactor(n),a=e.getBoundingClientRect(),l=a.left+window.pageXOffset,s=a.top+window.pageYOffset,c=t,d=[window],u=["auto","scroll"];c&&c!==document.body;){var _=window.getComputedStyle(c);(u.includes(_.overflowX)||u.includes(_.overflowY))&&d.push(c),c=c.parentElement}var p=null,f=!1,v=0,m=16;function w(){f||(f=!0,g())}function h(){f=!1,p&&(cancelAnimationFrame(p),p=null)}function g(){if(f){var t=performance.now();if(t-v>=m){var o=e.getBoundingClientRect(),i=o.left+window.pageXOffset,n=o.top+window.pageYOffset;(Math.abs(i-l)>.5||Math.abs(n-s)>.5)&&(C(),v=t,E())}p=requestAnimationFrame(g)}}var b=null,y=2e3;function E(){clearTimeout(b),b=setTimeout((function(){var o=e.getBoundingClientRect(),i=o.left+window.pageXOffset,n=o.top+window.pageYOffset,r=t.getAttribute("data-animate-prx")||t.getAttribute("data-animate-sbs-loop");Math.abs(i-l)<.5&&Math.abs(n-s)<.5&&!r?h():E()}),y)}for(var S=[],L=t;L&&L!==i;)S.push(L),L=L.parentElement;function A(){w()}function O(){setTimeout((function(){var t=e.getBoundingClientRect(),o=t.left+window.pageXOffset,i=t.top+window.pageYOffset;(Math.abs(o-l)>.5||Math.abs(i-s)>.5)&&C()}),50)}S.forEach((function(t){t.addEventListener("animationstart",A),t.addEventListener("animationiteration",A),t.addEventListener("animationend",O),t.addEventListener("transitionstart",A),t.addEventListener("transitionend",O)}));var T=new MutationObserver((function(t){var e;(e=t.some((function(t){return"attributes"===t.type&&("style"===t.attributeName||"class"===t.attributeName)})))&&w()}));function C(){var t=e.getBoundingClientRect(),i=t.left+window.pageXOffset,n=t.top+window.pageYOffset,a=(i-l)/r,c=(n-s)/r;if(0!==a||0!==c){var d=window.getComputedStyle(o).transform,u=new DOMMatrix(d),_=window.t396__isSafari?a*r:a,p=window.t396__isSafari?c*r:c;o.style.transform="\n\t\t\t\ttranslate("+(u.e+_)+"px, "+(u.f+p)+"px)\n\t\t\t",l=i,s=n}}function M(){t396_tooltip__hide(t),t396_tooltip__show(t)}S.forEach((function(t){T.observe(t,{attributes:!0,attributeFilter:["style","class"]})}));var q=d.map((function(e){var o=function o(){C(),w(),t396_tooltip__hideOnScroll(t,0,e)};return e.addEventListener("scroll",o,{passive:!0}),{container:e,listener:o}})),P=o.querySelector(".tn-atom__tip-img");return P&&0===P.naturalWidth&&t396_tooltip__updateTooltipOnImageResize(P,M),i.addEventListener("artBoardResized",M,{passive:!0}),w(),function t(){h(),clearTimeout(b),q.forEach((function(t){var e=t.container,o=t.listener;e.removeEventListener("scroll",o)})),S.forEach((function(t){t.removeEventListener("animationstart",A),t.removeEventListener("animationiteration",A),t.removeEventListener("animationend",O),t.removeEventListener("transitionstart",A),t.removeEventListener("transitionend",O)})),T.disconnect(),i.removeEventListener("artBoardResized",M)}}function t396_tooltip__setupImages(){var t=function t(){var e;document.querySelectorAll(".tn-atom__tip-img").forEach((function(t){var e=t.getAttribute("data-tipimg-original");e&&(t.src=e)}))},e=!1,o=function o(){e||(t(),e=!0)},i=setTimeout(o,3e3);window.addEventListener("load",(function(){clearTimeout(i),o()}))}function t396_tooltip__isShown(t){return t.classList.contains("tn-atom__tip_visible")}function t396_tooltip__getTooltipElement(t,e){return document.querySelector("#rec"+t+' .t396__elem[data-elem-id="'+e+'"]')}function t396_tooltip__hideOnScroll(t,e,o){if(void 0===e&&(e=0),void 0===o&&(o=null),t&&o!==window){var i=null,n={threshold:0};o&&(n.root=o);var r=new IntersectionObserver((function(o){var n;o[0].isIntersecting?i&&(clearTimeout(i),i=null):i||(i=setTimeout((function(){t396_tooltip__hide(t),r.disconnect()}),e))}),n);r.observe(t)}}function t396_tooltip__updateTooltipOnImageResize(t,e){var o=new ResizeObserver((function(t){t.forEach((function(t){var i=t.contentRect,n=i.width,r=i.height;n>0&&r>0&&(e(),o.disconnect())}))}));o.observe(t)}
